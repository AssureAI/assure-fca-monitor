# rules/cobs-suitability-v1.yaml
ruleset_id: assure-cobs-suitability
version: "1.2-cobs9-hardened"

rules:
  # -----------------------------
  # COBS 9 — Suitability
  # -----------------------------
  - id: COBS9_OBJ
    section: "COBS 9 — Suitability"
    title: "Client objectives identified"
    citation: "COBS 9.2.2R"
    source_url: "https://handbook.fca.org.uk/handbook/COBS/9/2.html"
    applies_when:
      advice_type: [advised]
    phrases:
      - "investment objective"
      - "your objectives"
      - "your goals"
      - "objective is to"
    min_hits: 1
    ok_reason: "Objectives language detected."
    missing_reason: "No clear objectives language found."

  - id: COBS9_OBJ_LINK
    section: "COBS 9 — Suitability"
    title: "Recommendation explicitly linked to objectives"
    citation: "COBS 9.2.2R"
    source_url: "https://handbook.fca.org.uk/handbook/COBS/9/2.html"
    applies_when:
      advice_type: [advised]
    phrases:
      - "based on your objectives"
      - "aligned to your objectives"
      - "in line with your objectives"
      - "meets your objectives because"
    min_hits: 1
    ok_reason: "Recommendation linked to objectives."
    missing_reason: "No explicit link from recommendation to objectives."

  - id: COBS9_RISK
    section: "COBS 9 — Suitability"
    title: "Attitude to risk assessed"
    citation: "COBS 9.2.2R"
    source_url: "https://handbook.fca.org.uk/handbook/COBS/9/2.html"
    applies_when:
      advice_type: [advised]
    phrases:
      - "attitude to risk"
      - "risk profile"
      - "risk tolerance"
      - "risk questionnaire"
      - "balanced"
      - "medium risk"
    min_hits: 1
    ok_reason: "Risk profiling language detected."
    missing_reason: "No clear risk profiling / risk category language found."

  - id: COBS9_RISK_LINK
    section: "COBS 9 — Suitability"
    title: "Recommendation explicitly linked to risk profile"
    citation: "COBS 9.2.2R"
    source_url: "https://handbook.fca.org.uk/handbook/COBS/9/2.html"
    applies_when:
      advice_type: [advised]
    phrases:
      - "aligned to your risk profile"
      - "in line with your risk profile"
      - "matches your assessed attitude to risk"
      - "based on your attitude to risk"
    min_hits: 1
    ok_reason: "Recommendation linked to risk profile."
    missing_reason: "No explicit link from recommendation to risk profile."

  - id: COBS9_CFL
    section: "COBS 9 — Suitability"
    title: "Capacity for loss addressed"
    citation: "COBS 9.2.2R"
    source_url: "https://handbook.fca.org.uk/handbook/COBS/9/2.html"
    applies_when:
      advice_type: [advised]
    phrases:
      - "capacity for loss"
      - "afford to lose"
      - "could afford"
      - "without materially affecting"
    min_hits: 1
    ok_reason: "Capacity for loss language detected."
    missing_reason: "No capacity for loss language found."

  - id: COBS9_CFL_STRENGTH
    section: "COBS 9 — Suitability"
    title: "Capacity for loss described with impact/meaning (not just named)"
    citation: "COBS 9.2.2R"
    source_url: "https://handbook.fca.org.uk/handbook/COBS/9/2.html"
    applies_when:
      advice_type: [advised]
    phrases:
      - "without materially affecting"
      - "standard of living"
      - "retirement plans"
      - "temporary fall"
      - "could afford a fall"
    min_hits: 1
    ok_reason: "Capacity for loss explained with impact."
    missing_reason: "Capacity for loss not explained beyond a label."

  - id: COBS9_TIME
    section: "COBS 9 — Suitability"
    title: "Investment time horizon stated"
    citation: "COBS 9.2.2R"
    source_url: "https://handbook.fca.org.uk/handbook/COBS/9/2.html"
    applies_when:
      advice_type: [advised]
    phrases:
      - "time horizon"
      - "over the next"
      - "years"
      - "until retirement"
    min_hits: 1
    ok_reason: "Time horizon language detected."
    missing_reason: "No clear time horizon language found."

  - id: COBS9_RATIONALE
    section: "COBS 9 — Suitability"
    title: "Suitability rationale given (why this solution fits the client)"
    citation: "COBS 9.2.1R / 9.2.2R"
    source_url: "https://handbook.fca.org.uk/handbook/COBS/9/2.html"
    applies_when:
      advice_type: [advised]
    phrases:
      - "this recommendation is suitable because"
      - "suitable because"
      - "this is suitable because"
      - "fits your circumstances"
      - "aligns with your circumstances"
    min_hits: 1
    ok_reason: "Suitability rationale detected."
    missing_reason: "No clear suitability rationale found (beyond generic growth language)."

  - id: COBS9_ALTS
    section: "COBS 9 — Suitability"
    title: "Alternatives / options considered"
    citation: "COBS 9.2.2R"
    source_url: "https://handbook.fca.org.uk/handbook/COBS/9/2.html"
    applies_when:
      advice_type: [advised]
    phrases:
      - "alternatives"
      - "other options"
      - "we considered"
      - "we also considered"
      - "keeping your existing"
    min_hits: 1
    ok_reason: "Alternatives language detected."
    missing_reason: "No discussion of alternatives/options found."

  - id: COBS9_DRAWBACKS
    section: "COBS 9 — Suitability"
    title: "Drawbacks / disadvantages disclosed"
    citation: "COBS 9.2.2R"
    source_url: "https://handbook.fca.org.uk/handbook/COBS/9/2.html"
    applies_when:
      advice_type: [advised]
    phrases:
      - "disadvantages"
      - "drawbacks"
      - "risks"
      - "potential disadvantages"
    min_hits: 1
    ok_reason: "Drawbacks/risks language detected."
    missing_reason: "No drawbacks/disadvantages language found."

  - id: COBS9_RETIREMENT_EQUITY_MISMATCH
    section: "COBS 9 — Suitability"
    title: "High equity allocation near retirement without balancing risk language"
    citation: "COBS 9.2.2R"
    source_url: "https://handbook.fca.org.uk/handbook/COBS/9/2.html"
    applies_when:
      advice_type: [advised]
    forbidden_phrases:
      - "80% global equity"
      - "90% global equity"
      - "100% equity"
    forbidden_allow_negation: true
    forbidden_reason: "High equity allocation flagged — ensure suitability/risk mitigation is clearly evidenced for near-retirement clients."

  # -----------------------------
  # COBS 6 — Costs & Charges
  # -----------------------------
  - id: COBS6_COSTS
    section: "COBS 6 — Costs & Charges"
    title: "Costs and charges disclosed"
    citation: "COBS 6.1ZA / 6.1ZB"
    source_url: "https://handbook.fca.org.uk/handbook/COBS/6/"
    applies_when:
      investment_element: true
    phrases:
      - "costs and charges"
      - "ongoing charge"
      - "platform charge"
      - "adviser charge"
      - "% per annum"
      - "total ongoing charge"
    min_hits: 1
    ok_reason: "Costs/charges language detected."
    missing_reason: "No clear costs/charges disclosure language found."

  # -----------------------------
  # COBS 4 — Communications
  # -----------------------------
  - id: COBS4_NO_GUARANTEE
    section: "COBS 4 — Communications"
    title: "No inappropriate guarantees / certainty language"
    citation: "COBS 4.2.1R"
    source_url: "https://handbook.fca.org.uk/handbook/COBS/4/2.html"
    applies_when:
      advice_type: [advised, nonadvised]
    forbidden_phrases:
      - "guaranteed return"
      - "risk-free"
      - "cannot lose"
      - "guaranteed growth"
      - "certain return"
    forbidden_allow_negation: true
    forbidden_reason: "Potential guarantee / certainty claim detected (check wording and risk warnings)."