ruleset_id: assure-cobs-investment-suitability
version: "1.0"

rules:

  - id: COBS9_OBJ
    obligation: Client investment objectives must be obtained and considered.
    citation: COBS 9.2.2R
    source_url: https://handbook.fca.org.uk/handbook/COBS/9/2.html
    applies_when:
      advice_type: advised
    evidence:
      positive_clusters:
        - ["objectives", "goals", "aims", "investment objective"]
        - ["growth", "income", "capital growth", "capital preservation"]
        - ["time horizon", "investment term", "long term", "short term"]
    decision_logic:
      ok_if:
        - ">=2 positive_clusters"

  - id: COBS9_CIRC
    obligation: Client personal and financial circumstances must be considered.
    citation: COBS 9.2.2R
    source_url: https://handbook.fca.org.uk/handbook/COBS/9/2.html
    applies_when:
      advice_type: advised
    evidence:
      positive_clusters:
        - ["income", "expenditure", "assets", "liabilities"]
        - ["employment", "retired", "self employed"]
        - ["dependants", "family", "spouse"]
    decision_logic:
      ok_if:
        - ">=2 positive_clusters"

  - id: COBS9_RISK
    obligation: Client attitude to risk must be assessed.
    citation: COBS 9.2.2R
    source_url: https://handbook.fca.org.uk/handbook/COBS/9/2.html
    applies_when:
      advice_type: advised
    evidence:
      positive_clusters:
        - ["attitude to risk", "risk profile", "risk tolerance"]
        - ["cautious", "balanced", "moderate", "adventurous"]
      negative_indicators:
        - ["guaranteed", "no risk", "cannot lose"]
    decision_logic:
      ok_if:
        - ">=1 positive_clusters"
        - "==0 negative_indicators"

  - id: COBS9_CFL
    obligation: Client capacity for loss must be considered.
    citation: COBS 9.2.2R
    source_url: https://handbook.fca.org.uk/handbook/COBS/9/2.html
    applies_when:
      advice_type: advised
    evidence:
      positive_clusters:
        - ["capacity for loss", "loss capacity"]
        - ["afford to lose", "financially resilient"]
    decision_logic:
      ok_if:
        - ">=1 positive_clusters"

  - id: COBS9_RECO
    obligation: A clear personal recommendation must be made.
    citation: COBS 9.2.1R
    source_url: https://handbook.fca.org.uk/handbook/COBS/9/2.html
    applies_when:
      advice_type: advised
    evidence:
      positive_clusters:
        - ["we recommend", "our recommendation", "we advise"]
        - ["invest", "allocate", "switch", "contribute"]
    decision_logic:
      ok_if:
        - ">=1 positive_clusters"

  - id: COBS9_RATIONALE
    obligation: The suitability of the recommendation must be explained.
    citation: COBS 9.2.1R
    source_url: https://handbook.fca.org.uk/handbook/COBS/9/2.html
    applies_when:
      advice_type: advised
    evidence:
      positive_clusters:
        - ["this is suitable", "meets your objectives"]
        - ["given your circumstances", "based on your needs"]
    decision_logic:
      ok_if:
        - ">=1 positive_clusters"

  - id: COBS9_RISKS
    obligation: Material risks of the recommendation must be explained.
    citation: COBS 9.2.1R
    source_url: https://handbook.fca.org.uk/handbook/COBS/9/2.html
    applies_when:
      advice_type: advised
    evidence:
      positive_clusters:
        - ["risk", "volatility", "market movements"]
        - ["capital at risk", "value can fall"]
    decision_logic:
      ok_if:
        - ">=2 positive_clusters"

  - id: COBS6_COSTS
    obligation: Costs and charges must be disclosed.
    citation: COBS 6.1ZA / COBS 6.1ZB
    source_url: https://handbook.fca.org.uk/handbook/COBS/6/
    applies_when:
      investment_element: true
    evidence:
      positive_clusters:
        - ["cost", "charge", "fee"]
        - ["percentage", "%", "monetary"]
    decision_logic:
      ok_if:
        - ">=2 positive_clusters"

  - id: COBS9_ALTS
    obligation: Reasonable alternatives must be considered.
    citation: COBS 9.2.1R
    source_url: https://handbook.fca.org.uk/handbook/COBS/9/2.html
    applies_when:
      advice_type: advised
    evidence:
      positive_clusters:
        - ["alternative", "other options"]
        - ["considered alternatives", "decided against"]
    decision_logic:
      ok_if:
        - ">=1 positive_clusters"

  - id: COBS9_DRAWBACKS
    obligation: Disadvantages of the recommendation must be explained.
    citation: COBS 9.2.1R
    source_url: https://handbook.fca.org.uk/handbook/COBS/9/2.html
    applies_when:
      advice_type: advised
    evidence:
      positive_clusters:
        - ["drawbacks", "disadvantages", "downsides"]
    decision_logic:
      ok_if:
        - ">=1 positive_clusters"

  - id: COBS4_GUAR
    obligation: Communications must not imply certainty or guarantees.
    citation: COBS 4.2.1R
    source_url: https://handbook.fca.org.uk/handbook/COBS/4/2.html
    applies_when:
      investment_element: true
    evidence:
      negative_indicators:
        - ["guaranteed", "no risk", "cannot lose", "certain return"]
    decision_logic:
      ok_if:
        - "==0 negative_indicators"

  - id: COBS4_BALANCE
    obligation: Benefits and risks must be presented in a balanced manner.
    citation: COBS 4.2.1R
    source_url: https://handbook.fca.org.uk/handbook/COBS/4/2.html
    applies_when:
      investment_element: true
    evidence:
      positive_clusters:
        - ["benefits", "advantages"]
        - ["risks", "drawbacks"]
    decision_logic:
      ok_if:
        - ">=2 positive_clusters"

  - id: STRUCT_TIME
    obligation: Investment time horizon should be referenced.
    citation: COBS 9.2.2R
    source_url: https://handbook.fca.org.uk/handbook/COBS/9/2.html
    applies_when:
      investment_element: true
    evidence:
      positive_clusters:
        - ["time horizon", "investment term", "long term", "short term"]
    decision_logic:
      ok_if:
        - ">=1 positive_clusters"

  - id: STRUCT_ONGOING
    obligation: Ongoing service must be explained where provided.
    citation: COBS 9.2.1R
    source_url: https://handbook.fca.org.uk/handbook/COBS/9/2.html
    applies_when:
      ongoing_service: true
    evidence:
      positive_clusters:
        - ["ongoing service", "ongoing advice"]
    decision_logic:
      ok_if:
        - ">=1 positive_clusters"

  - id: STRUCT_REVIEW
    obligation: Review frequency should be stated where ongoing service applies.
    citation: COBS 9.2.1R
    source_url: https://handbook.fca.org.uk/handbook/COBS/9/2.html
    applies_when:
      ongoing_service: true
    evidence:
      positive_clusters:
        - ["annual review", "regular review", "six monthly"]
    decision_logic:
      ok_if:
        - ">=1 positive_clusters"
